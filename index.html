<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta property="og:type" content="website">
<meta property="og:title" content="yliw">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="yliw">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="yliw">
<meta name="twitter:card" content="summary"><title>yliw</title><link ref="canonical" href="http://example.com/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">yliw</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/09/16/Mybatis/">Mybatis</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2022-09-16</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2022-09-16</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="一-搭建Mybaits环境"   >
          <a href="#一-搭建Mybaits环境" class="heading-link"><i class="fas fa-link"></i></a><a href="#一-搭建Mybaits环境" class="headerlink" title="一.搭建Mybaits环境"></a>一.搭建Mybaits环境</h3>
      <p>1.创建maven工程<br>2.引入依赖</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;!--添加mybatis框架的依赖--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;3.5.6&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;!--添加mysql8.0驱动--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;8.0.28&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>


<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--添加资源文件的指定--&gt;</span><br><span class="line">  &lt;build&gt;</span><br><span class="line">      &lt;resources&gt;</span><br><span class="line">          &lt;resource&gt;</span><br><span class="line">              &lt;directory&gt;src/main/java&lt;/directory&gt;</span><br><span class="line">              &lt;includes&gt;</span><br><span class="line">                  &lt;include&gt;**/*.xml&lt;/include&gt;</span><br><span class="line">                  &lt;include&gt;**/*.properties&lt;/include&gt;</span><br><span class="line">              &lt;/includes&gt;</span><br><span class="line">          &lt;/resource&gt;</span><br><span class="line"></span><br><span class="line">          &lt;resource&gt;</span><br><span class="line">              &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">              &lt;includes&gt;</span><br><span class="line">                  &lt;include&gt;**/*.xml&lt;/include&gt;</span><br><span class="line">                  &lt;include&gt;**/*.properties&lt;/include&gt;</span><br><span class="line">              &lt;/includes&gt;</span><br><span class="line">          &lt;/resource&gt;</span><br><span class="line">      &lt;/resources&gt;</span><br><span class="line">  &lt;/build&gt;</span><br></pre></td></tr></table></div></figure>
<p>3.在IDEA中添加数据库的可视化（非必要）</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IDEA右上角database--&gt;+号</span><br></pre></td></tr></table></div></figure>

<p>4.resources目录下添加jdbc.properties属性文件（数据库的配置）</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driverClassName=com.mysql.cj.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://localhost:3306/ssm?useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf8</span><br><span class="line">jdbc.username=root</span><br><span class="line">jdbc.password=Qiu028468</span><br></pre></td></tr></table></div></figure>


<p>5.添加SqlMapConfig.xml文件，Mybaits的核心配置文件</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="line">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--读取属性文件(jdbc.properties)</span><br><span class="line">      属性:</span><br><span class="line">         resources:从resources目录下找指定名称的文件加载</span><br><span class="line">         url:使用绝对路径加载属性文件</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;properties resource=<span class="string">&quot;jdbc.properties&quot;</span>&gt;&lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--配置数据库的环境变量(数据库连接配置)</span><br><span class="line">       default:使用下面的environment标签的<span class="built_in">id</span>属性进行指定配置</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;environments default=<span class="string">&quot;development&quot;</span>&gt;</span><br><span class="line">        &lt;!--开发时在公司使用的数据库配置</span><br><span class="line">          <span class="built_in">id</span>:就是提供给environments的default属性使用</span><br><span class="line">        --&gt;</span><br><span class="line">        &lt;environment <span class="built_in">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span><br><span class="line">            &lt;!--配置事务管理器</span><br><span class="line">               <span class="built_in">type</span>:指定事务管理的方式</span><br><span class="line">                  JDBC:事务的控制交给程序员处理</span><br><span class="line">                  MANAGED:由容器(Spring)来管理事务</span><br><span class="line">            --&gt;</span><br><span class="line">            &lt;transactionManager <span class="built_in">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;&lt;/transactionManager&gt;</span><br><span class="line">            &lt;!--配置数据源</span><br><span class="line">               <span class="built_in">type</span>:指定不同的配置方式</span><br><span class="line">                  JNDI:java命名目录接口,在服务器端进行数据库连接池的管理</span><br><span class="line">                  POOLED:使用数据库连接池</span><br><span class="line">                  UNPOLLED:不使用数据库连接池</span><br><span class="line">            --&gt;</span><br><span class="line">            &lt;dataSource <span class="built_in">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span><br><span class="line">                &lt;!--配置数据库连接的基本参数</span><br><span class="line">                    private String driver;</span><br><span class="line">                    private String url;</span><br><span class="line">                    private String username;</span><br><span class="line">                    private String password;</span><br><span class="line">                --&gt;</span><br><span class="line">                &lt;property name=<span class="string">&quot;driver&quot;</span> value=<span class="string">&quot;<span class="variable">$&#123;jdbc.driverClassName&#125;</span>&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">                &lt;property name=<span class="string">&quot;url&quot;</span> value=<span class="string">&quot;<span class="variable">$&#123;jdbc.url&#125;</span>&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">                &lt;property name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;<span class="variable">$&#123;jdbc.username&#125;</span>&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">                &lt;property name=<span class="string">&quot;password&quot;</span> value=<span class="string">&quot;<span class="variable">$&#123;jdbc.password&#125;</span>&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!--在家的数据库配置--&gt;</span><br><span class="line">        &lt;!--&lt;environment <span class="built_in">id</span>=<span class="string">&quot;home&quot;</span>&gt;--&gt;</span><br><span class="line">            &lt;!--&lt;transactionManager <span class="built_in">type</span>=<span class="string">&quot;&quot;</span>&gt;&lt;/transactionManager&gt;--&gt;</span><br><span class="line">            &lt;!--&lt;dataSource <span class="built_in">type</span>=<span class="string">&quot;&quot;</span>&gt;&lt;/dataSource&gt;--&gt;</span><br><span class="line">        &lt;!--&lt;/environment&gt;--&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!--上线后的数据库配置--&gt;</span><br><span class="line">        &lt;!--&lt;environment <span class="built_in">id</span>=<span class="string">&quot;online&quot;</span>&gt;--&gt;</span><br><span class="line">            &lt;!--&lt;transactionManager <span class="built_in">type</span>=<span class="string">&quot;&quot;</span>&gt;&lt;/transactionManager&gt;--&gt;</span><br><span class="line">            &lt;!--&lt;dataSource <span class="built_in">type</span>=<span class="string">&quot;&quot;</span>&gt;&lt;/dataSource&gt;--&gt;</span><br><span class="line">        &lt;!--&lt;/environment&gt;--&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--注册mapper.xml文件</span><br><span class="line">       resource:从resources目录下找指定名称的文件注册</span><br><span class="line">       url:使用绝对路径注册</span><br><span class="line">       class:动态代理方式下的注册</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=<span class="string">&quot;StudentMapper.xml&quot;</span>&gt;&lt;/mapper&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></div></figure>



<p>6.创建学生实体类Student用来封装数据<br>7.添加完成学生表的增删改查操作的StudentMapper.xml</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="line">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">  mapper:是整个文件的大标签,用来开始和结束xml文件</span><br><span class="line">  属性:</span><br><span class="line">     namespace:指定命名空间(相当于包名),用来区分不同mapper.xml文件中相同的<span class="built_in">id</span>属性</span><br><span class="line">--&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;tjh&quot;</span>&gt;</span><br><span class="line">    &lt;!--</span><br><span class="line">      完成查询全部学生的功能</span><br><span class="line">      List&lt;Student&gt; getALL();</span><br><span class="line">         resultType:指定查询返回的结果集的类型,如果是集合,则必须是泛型的类型</span><br><span class="line">         parameterType:如果有参数,则通过它来指定参数的类型</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;select <span class="built_in">id</span>=<span class="string">&quot;getAll&quot;</span> resultType=<span class="string">&quot;com.xxx.pojo.Student&quot;</span>&gt;</span><br><span class="line">        select <span class="built_in">id</span>,name,email,age from student</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></div></figure>


<p>8.创建测试类测试数据</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class <span class="built_in">test</span> &#123;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void test01() throws IOException &#123;</span><br><span class="line">        //使用文件流读取核心配置文件SqlMapperConfig.xml</span><br><span class="line">        InputStream <span class="keyword">in</span> = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        //创建SqlSessionFactory工厂</span><br><span class="line">        SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(<span class="keyword">in</span>);</span><br><span class="line">        //去除sqlSession对象</span><br><span class="line">        SqlSession sqlSession = factory.openSession();</span><br><span class="line">        //完成查询操作</span><br><span class="line">        List&lt;Student&gt; list = sqlSession.selectList(<span class="string">&quot;tjh.getAll&quot;</span>);</span><br><span class="line">        list.forEach(student -&gt; System.out.println(student));</span><br><span class="line">        //关闭sqlsession</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/08/17/%E4%BA%8B%E5%8A%A1/">事务</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2022-08-17</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2022-08-17</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="一-事务的简介"   >
          <a href="#一-事务的简介" class="heading-link"><i class="fas fa-link"></i></a><a href="#一-事务的简介" class="headerlink" title="一.事务的简介"></a>一.事务的简介</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">事务是一组操作集合，它是一个不可分割的工作单位，</span><br><span class="line">事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，</span><br><span class="line">即这些操作要么同时成功，要没同时失效</span><br><span class="line">典型案例：银行转账</span><br></pre></td></tr></table></div></figure>


        <h3 id="二-事务的操作"   >
          <a href="#二-事务的操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#二-事务的操作" class="headerlink" title="二.事务的操作"></a>二.事务的操作</h3>
      <p>2.1 转账操作案例</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.查询张三账户余额</span><br><span class="line">select * from account <span class="built_in">where</span> name=<span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">2.将张三账户减去1000元</span><br><span class="line">update account <span class="built_in">set</span> money = money -1000 <span class="built_in">where</span> name=<span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">3.将李四账户添加1000元</span><br><span class="line">update account <span class="built_in">set</span> money =money +1000 <span class="built_in">where</span> name=<span class="string">&#x27;李四&#x27;</span>;</span><br></pre></td></tr></table></div></figure>


<p>2.2 如果第一步，第二步执行成功，第三步执行失败</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.查询张三账户余额</span><br><span class="line">select * from account <span class="built_in">where</span> name=<span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">2.将张三账户减去1000元</span><br><span class="line">update account <span class="built_in">set</span> money = money -1000 <span class="built_in">where</span> name=<span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">程序抛出异常......</span><br><span class="line"> </span><br><span class="line">3.将李四账户添加1000元</span><br><span class="line">update account <span class="built_in">set</span> money =money +1000 <span class="built_in">where</span> name=<span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line">这个时候张三的账户已经被减去1000元，但是李四的账户并未增加1000元。</span><br></pre></td></tr></table></div></figure>


<p>2.3 解决办法</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql的事务是自动提交的，我们可以将事务设置成手动提交</span><br><span class="line"></span><br><span class="line">.查看/设置事务提交方式</span><br><span class="line"> select @@autocommit 查看事务提交方式--&gt;如果为1是自动提交</span><br><span class="line"></span><br><span class="line"> <span class="built_in">set</span> @@autocommit =0 设置成手动提交</span><br><span class="line"></span><br><span class="line"> start transaction 或者begin 开启事务</span><br><span class="line">  </span><br><span class="line"> .提交事务</span><br><span class="line"> 必须执行commit指令才能手动提交事务</span><br><span class="line">  </span><br><span class="line"> .回滚事务</span><br><span class="line"> 如过在执行的过程中出现异常需要回滚数据rollback</span><br></pre></td></tr></table></div></figure>



<p>2.4 转账流程修改</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1.查看事务</span><br><span class="line"> select @@autocommit;</span><br><span class="line"></span><br><span class="line">2.设置事务</span><br><span class="line"> <span class="built_in">set</span> @@autocommit = 0;</span><br><span class="line">  </span><br><span class="line">3.查询张三账户余额</span><br><span class="line"> select * from account <span class="built_in">where</span> name=<span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> .将张三账户减去1000元</span><br><span class="line"> update account <span class="built_in">set</span> money = money -1000 <span class="built_in">where</span> name=<span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> 如果程序抛出异常......</span><br><span class="line"></span><br><span class="line"> .将李四账户添加1000元</span><br><span class="line"> update account <span class="built_in">set</span> money =money +1000 <span class="built_in">where</span> name=<span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">4.没有异常则提交事务</span><br><span class="line"> commit;</span><br><span class="line"></span><br><span class="line">5.存在异常则回滚事务</span><br><span class="line"> rollback;</span><br></pre></td></tr></table></div></figure>


        <h3 id="三-事务的四大特性（-）"   >
          <a href="#三-事务的四大特性（-）" class="heading-link"><i class="fas fa-link"></i></a><a href="#三-事务的四大特性（-）" class="headerlink" title="三.事务的四大特性（******）"></a>三.事务的四大特性（******）</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">原子性：事务是不可分割的最小操作单元，要么全部成功，要么全部失败。</span><br><span class="line">一致性：事务完成时，必须使所有数据都保持一致状态。（不能多也不能少）</span><br><span class="line">隔离性：数据库系统提供的隔离机制，保证事务不受外部并发操作影响的独立环境下运行</span><br><span class="line">如：多个事务同时在操做这个数据库时 A事务不会影响并发的B事务执行，B也不会影响A </span><br><span class="line">持久性：事务一旦提交或者回滚，它对数据库中的数据的改变就是永久的。</span><br></pre></td></tr></table></div></figure>


        <h3 id="四-并发事务问题"   >
          <a href="#四-并发事务问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#四-并发事务问题" class="headerlink" title="四.并发事务问题"></a>四.并发事务问题</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A事务与B事务在同时操作一个数据库或者一张表的时候所引发的问题</span><br><span class="line">1.脏读：一个事务读到另一个事务还没有提交的数据</span><br><span class="line">2.不可重复读：一个事务先后读取同一条记录，但两次读取的数据不同。</span><br><span class="line">3.一个事务按照条件查询数据时，没有对应的数据行，但是在插入数据时，</span><br><span class="line"> 又发现这行数据已经存在。</span><br></pre></td></tr></table></div></figure>


        <h3 id="五-事务的隔离级别-解决并发事务所引发的问题"   >
          <a href="#五-事务的隔离级别-解决并发事务所引发的问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#五-事务的隔离级别-解决并发事务所引发的问题" class="headerlink" title="五.事务的隔离级别-解决并发事务所引发的问题"></a>五.事务的隔离级别-解决并发事务所引发的问题</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">隔离级别                      脏读   不可重复读  幻读</span><br><span class="line"> Read uncommitted 读未提交      O        O         O</span><br><span class="line"> Read committed   读已提交      X        O         O</span><br><span class="line"> Repeatable(默认) 可重复读      X        X         O（无法解决）</span><br><span class="line"> serializable     串行化        X        X         X（不会出现）</span><br><span class="line"> </span><br><span class="line"> Read uncommitted 性能最高，数据安全性最差</span><br><span class="line"> serializable     性能最差，数据安全性最高</span><br><span class="line"> </span><br><span class="line"> 查看事务的隔离级别</span><br><span class="line"> select @@transaction_isolation</span><br><span class="line"> </span><br><span class="line"> 设置事务隔离级别</span><br><span class="line"> <span class="built_in">set</span> [session | global] transaction isolation level &#123;隔离级别&#125;;</span><br></pre></td></tr></table></div></figure>







<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">作者：yliw</span><br><span class="line">时间：2022/8/17</span><br><span class="line">                 仅供学习，若有错误，请联系作者指正。</span><br></pre></td></tr></table></div></figure></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/08/16/MySQL%E5%9F%BA%E7%A1%80-0/">多表查询</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2022-08-16</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2022-08-17</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="一-多表关系"   >
          <a href="#一-多表关系" class="heading-link"><i class="fas fa-link"></i></a><a href="#一-多表关系" class="headerlink" title="一.多表关系"></a>一.多表关系</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在进行数据库的表结构设计时，会根据业务需求及业务模块之间的关系，</span><br><span class="line">分析设计表结构，由于业务之间相互关联，所以各个表之间也存在着各种联系</span><br><span class="line">基本上分为三种：</span><br><span class="line">一对多</span><br><span class="line">多对多  </span><br><span class="line"> 实现：建立第三张中间表，中间表至少包含两个外键，分别关联两方主键</span><br><span class="line">一对一  </span><br><span class="line"> 实现：在任意一方加入一个外键，关联另外一方的主键，并且设置外键为唯一的unique</span><br></pre></td></tr></table></div></figure>

<p>1.笛卡儿积</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">假设集合A=&#123;a, b&#125;，集合B=&#123;0, 1, 2&#125;，</span><br><span class="line">则两个集合的笛卡尔积为&#123;(a, 0), (a, 1), (a, 2), (b, 0), (b, 1), (b, 2)&#125;</span><br><span class="line">实现：select * from a表，b表 <span class="built_in">where</span> a.id=b.id；</span><br></pre></td></tr></table></div></figure>


        <h3 id="二-多表查询"   >
          <a href="#二-多表查询" class="heading-link"><i class="fas fa-link"></i></a><a href="#二-多表查询" class="headerlink" title="二.多表查询"></a>二.多表查询</h3>
      <p>1.内连接</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">两张表交集的部分</span><br><span class="line">隐式内连接：select 字段列表 from 表1，表2　ｗhere　条件．．；</span><br><span class="line">显示内连接 select 字段列表 from 表1 <span class="built_in">join</span> 表2 on 连接条件...;</span><br></pre></td></tr></table></div></figure>


<p>2.外连接</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">左外连接 select  字段列表 from 表1 left <span class="built_in">join</span> 表2 on 条件....；</span><br><span class="line">查询表1（左表）所有数据和，以及表1和表2交集部分。</span><br><span class="line"></span><br><span class="line">右外连接: select 字段列表 from 表1 right <span class="built_in">join</span> 表2 on 条件...；</span><br><span class="line">查询表2（右表）所有数据，以及...........</span><br></pre></td></tr></table></div></figure>



<p>3.自连接</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">自连接可以是内连接，也可以是外连接，看成两张表</span><br><span class="line">例如：</span><br><span class="line">1-自连接</span><br><span class="line">查询emp表员工及其所属领导</span><br><span class="line">select a.name，b.name from emp a,emp b <span class="built_in">where</span> a.mangerid = b.id；</span><br><span class="line">2-外连接</span><br><span class="line">查询所有员工及其领导的名字，如果员工没有领导也要查出来（左外连接）</span><br><span class="line">select a.name ,b.name from emp a left <span class="built_in">join</span> emp b on  a.mangerid = b.id</span><br></pre></td></tr></table></div></figure>

<p>4.联合查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">常见字符 union ,union all</span><br><span class="line">将两个查询结果直接拼接</span><br><span class="line">对于联合查询的多张表的列数必须保持一致，字段类型也需要保持一致 </span><br><span class="line">union all 会将全部数据直接合并在一起，union会合并之后对数据进行去重</span><br><span class="line">  select * from emp <span class="built_in">where</span> 工资&lt;5000</span><br><span class="line">  union </span><br><span class="line">  select * from emp  <span class="built_in">where</span> age&gt;50</span><br></pre></td></tr></table></div></figure>



<p>5.子查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">概念：SQL语句中嵌套select 语句，称为嵌套查询，又称子查询</span><br><span class="line">子查询外部语句可以是增删改查的任何一个</span><br><span class="line"> 子查询可分为：</span><br><span class="line">  标量子查询（子查询结果为单个值）</span><br><span class="line">  列子查询（子查询结果为一列）</span><br><span class="line">  行子查询（子查询结果为一行）</span><br><span class="line">  表子查询（子查询结果为多行多列）</span><br></pre></td></tr></table></div></figure>

<p>5.1 标量子查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">例：查询销售部所有员工信息</span><br><span class="line"> 查询销售部部门<span class="built_in">id</span></span><br><span class="line">  select <span class="built_in">id</span> from dopt <span class="built_in">where</span> name=<span class="string">&#x27;销售部&#x27;</span>;</span><br><span class="line">  根据部门<span class="built_in">id</span>查询员工信息</span><br><span class="line">  select * from dopt <span class="built_in">where</span>=(select <span class="built_in">id</span> from dopt <span class="built_in">where</span> name=<span class="string">&#x27;销售部&#x27;</span>);</span><br></pre></td></tr></table></div></figure>
<p>5.2 列子查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">常用符号：</span><br><span class="line"> <span class="keyword">in</span>--&gt;在指定范围内多选一 、</span><br><span class="line"> not <span class="keyword">in</span>--&gt;在不指定集合范围内、</span><br><span class="line"> any--&gt;子查询范围列表中，有任意一个满足即可、</span><br><span class="line"> some--&gt;与any等同，使用some的地方都可以使用any、</span><br><span class="line"> all--&gt;子查询返回列表所有值都必须满足</span><br><span class="line">  例：查询销售部和市场部员工信息</span><br><span class="line">  查询两个部门<span class="built_in">id</span></span><br><span class="line">   select <span class="built_in">id</span> from dopt <span class="built_in">where</span> name=<span class="string">&#x27;销售部&#x27;</span> or name=<span class="string">&#x27;市场部&#x27;</span>;</span><br><span class="line">   根据<span class="built_in">id</span>查员工信息</span><br><span class="line">   select * from dopt <span class="built_in">where</span> dopt_id <span class="keyword">in</span></span><br><span class="line">    （select <span class="built_in">id</span> from dopt <span class="built_in">where</span> name=<span class="string">&#x27;销售部&#x27;</span> or name=<span class="string">&#x27;市场部&#x27;</span>）；</span><br></pre></td></tr></table></div></figure>
<p>5.3 行子查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">常见的操作符：=、&lt;&gt;、<span class="keyword">in</span>、not <span class="keyword">in</span></span><br><span class="line"> 例：selcet * from emp <span class="built_in">where</span> （字段1，字段2）=</span><br><span class="line">   （select 字段1，字段2 from emp <span class="built_in">where</span> name=<span class="string">&#x27;a&#x27;</span>）;</span><br></pre></td></tr></table></div></figure>

<p>5.4 表子查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">子查询返回的结果是多行多列，这种子查询称为表子查询</span><br><span class="line"> 常用操作符 <span class="keyword">in</span></span><br><span class="line">   </span><br><span class="line"> 例1：查询与a员工 b员工的职位和薪资相同的员工信息</span><br><span class="line">  1.查询a.b员工的职位和薪资</span><br><span class="line">  select 职位字段，薪资字段 from emp <span class="built_in">where</span> name=<span class="string">&#x27;a&#x27;</span> or name<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">	</span><br><span class="line">  2.查询与a、b的职位和薪资相同的员工</span><br><span class="line">   select*from emp <span class="built_in">where</span> （职位字段，薪资字段）<span class="keyword">in</span> </span><br><span class="line">    （select 职位字段，薪资字段 from emp <span class="built_in">where</span> name=<span class="string">&#x27;a&#x27;</span> or name<span class="string">&#x27;b&#x27;</span>）;</span><br><span class="line">	</span><br><span class="line"> 例2:查询入职日期是2006-01-02之后入职的员工信息，及其部门信息</span><br><span class="line">  员工信息表emp 部门表dept </span><br><span class="line">	</span><br><span class="line">  a.入职日期是2006-01-02之后的员工信息</span><br><span class="line">  select * from emp <span class="built_in">where</span> 入职日期&gt;<span class="string">&#x27;20006-01-02&#x27;</span>;</span><br><span class="line">	</span><br><span class="line">  b.查询这部分员工对应的部门信息</span><br><span class="line">  select e.*,d.* from (select * from emp <span class="built_in">where</span> 入职日期&gt;<span class="string">&#x27;20006-01-02&#x27;</span>)e</span><br><span class="line">   left <span class="built_in">join</span> dept d on e.dept=d.id;</span><br></pre></td></tr></table></div></figure>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">作者：yliw</span><br><span class="line">时间：2022/8/17</span><br><span class="line">                 仅供学习，若有错误，请联系作者指正。</span><br></pre></td></tr></table></div></figure></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/08/15/MYSQL%E5%9F%BA%E7%A1%80/">MySQL基础</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2022-08-15</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2022-08-17</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="一-DDL"   >
          <a href="#一-DDL" class="heading-link"><i class="fas fa-link"></i></a><a href="#一-DDL" class="headerlink" title="一.DDL"></a>一.DDL</h3>
      <p>1.DDL-数据库操作</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查询所有数据库    show database;</span><br><span class="line">查询当前数据库    show database();</span><br><span class="line">创建数据库        create database [<span class="keyword">if</span> not exists] 数据库名 [default charset 字符集][collate排序规则]</span><br><span class="line">删除数据库        drop database[<span class="keyword">if</span> exists]数据库名</span><br><span class="line">使用             use 数据库名</span><br></pre></td></tr></table></div></figure>

<p>2.DDL-表操作-创建表</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">查询当前数据库所有表    show tabase</span><br><span class="line">查询表结构             desc 表名</span><br><span class="line">查询指定表的建表语句    show create table 表名</span><br><span class="line">创建表--&gt;</span><br><span class="line">    create table 表名（</span><br><span class="line">	    <span class="built_in">id</span> int comment <span class="string">&#x27;编号&#x27;</span>,</span><br><span class="line">	    name varcher(50) comment <span class="string">&#x27;姓名’</span></span><br><span class="line"><span class="string">	）comment &#x27;</span>用户表<span class="string">&#x27; ;  comment==注释</span></span><br></pre></td></tr></table></div></figure>

<p>3.DDL-表操作-数据类型</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">变长字符串与定长字符串的区别</span><br><span class="line">变长字符串 varchar   varchar(255)  所占资源空间是你存储内容的长度</span><br><span class="line">定长字符串 char     char(8)   不管你存储内容的长度是多少，它所占空间就是8，如果存储内容长度大于8，则会被截取</span><br><span class="line">所以：varchar相较于char，更能节省资源空间</span><br><span class="line">但是 ，还有一种，数据库对定长字段操作有优化，数据量量大时做特定操作时，会比变长字符串快很多。</span><br></pre></td></tr></table></div></figure>

<p>4.DDL-表操作-修改</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">添加字段: alter table 表名 add 字段名 类型（长度）comment <span class="string">&#x27;昵称&#x27;</span>;</span><br><span class="line">修改字段  </span><br><span class="line">.修改数据类型: alter table 表名 modife 字段名 新数据类型（长度）</span><br><span class="line">.修改字段名和字段类型: alter table 表名 change 旧字段名 新字段名 类型（长度） comment <span class="string">&#x27;注释&#x27;</span></span><br><span class="line">删除字段: alter table 表名 drop 字段名</span><br><span class="line">修改表名: alter table 表明 rename to 新表名</span><br><span class="line">删除表:   drop table [<span class="keyword">if</span> exists]表名；</span><br><span class="line">删除指定表并重新创建: <span class="built_in">truncate</span> table 表名;</span><br></pre></td></tr></table></div></figure>

        <h3 id="二-DML-对表的增删改"   >
          <a href="#二-DML-对表的增删改" class="heading-link"><i class="fas fa-link"></i></a><a href="#二-DML-对表的增删改" class="headerlink" title="二.DML-对表的增删改"></a>二.DML-对表的增删改</h3>
      <p>1.DML-添加数据</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">给指定字段添加数据 insert into 表名（字段名1，字段名2，...）values(值1，值2，...);</span><br><span class="line">给全部字段添加数据 insert into 表名 values (值1，值2，....);</span><br><span class="line">批量添加数据</span><br><span class="line">insert into 表名（字段名1，字段名2，...）values(值1，值2，...),(值1，值2，...);</span><br><span class="line">insert into 表名 values (值1，值2，...),(值1，值2，...),(值1，值2，...);</span><br><span class="line"></span><br><span class="line">注意:插入数据时，指定的字段顺序需要与值的顺序是一一对应</span><br></pre></td></tr></table></div></figure>

<p>2.DML-修改操作</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update 表名 <span class="built_in">set</span> 字段名1=值1，字段名2=值2，... [<span class="built_in">where</span> 条件]；</span><br><span class="line">注意：可以有条件，也可以没有条件，如果没有条件则修改该表该字段的所有数据</span><br></pre></td></tr></table></div></figure>

<p>3.DML-删除数据</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">delete from 表名 [<span class="built_in">where</span> 条件]；</span><br><span class="line">注意：如果没有条件则删除该表所有数据</span><br><span class="line">	   delete语句不能删除某一个字段的值（可以使用update）</span><br></pre></td></tr></table></div></figure>


        <h3 id="三-DQL-数据查询操作（重要）"   >
          <a href="#三-DQL-数据查询操作（重要）" class="heading-link"><i class="fas fa-link"></i></a><a href="#三-DQL-数据查询操作（重要）" class="headerlink" title="三.DQL-数据查询操作（重要）"></a>三.DQL-数据查询操作（重要）</h3>
      <p>单表查询</p>
<p>1.基本查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查询指定字段并返回  select 字段名1，字段名2，字段名3 from 表名;</span><br><span class="line">查询所有字段并返回  select * from 表名; （实际开发尽量写字段，尽量少用*）</span><br><span class="line">查询字段起别名      select 字段名1 as <span class="string">&#x27;别名&#x27;</span> from  表名;   (as可以省略)</span><br><span class="line">查询字段并去重复    select distinct 字段名1 from 表名;</span><br></pre></td></tr></table></div></figure>
<p>2.条件查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select *（或者字段名） from 表名 <span class="built_in">where</span> 条件列表;</span><br><span class="line">条件：</span><br><span class="line">1.比较运算 &gt; &gt;= &lt; &lt;= = </span><br><span class="line">2.&lt;&gt;或 ！= 不等于   between...and...在某个范围内（and后边跟的最大值）</span><br><span class="line">3.<span class="keyword">in</span>(...)括号里面的满足一个就行 </span><br><span class="line">  例如：查询年龄等于18或20或24的人 select * from 表名 age <span class="keyword">in</span>(18,20,24);</span><br><span class="line">4.like 模糊查询 _查询单个字符 %查询任意字符</span><br><span class="line">例如：查询姓名为两个字的人 </span><br><span class="line">  select * from 表名 <span class="built_in">where</span> name like <span class="string">&#x27;_ _&#x27;</span>;</span><br><span class="line">  (两个下划线代表两个字符，三个代表三个字的名字)</span><br><span class="line">  (最后一位是x --&gt; %x   查询姓王的--&gt; 王%）</span><br><span class="line">5.is null 是null</span><br><span class="line">6.逻辑运算符</span><br><span class="line">7.and 或&amp;&amp;  --&gt; 并且     or或 ||  --&gt;或者</span><br><span class="line">8.not或 ！ --&gt;非 不是</span><br></pre></td></tr></table></div></figure>

<p>3.聚合函数</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">聚合函数是作用于某一列的计算</span><br><span class="line">	常见的聚合函数 </span><br><span class="line">	 1.count 统计数量</span><br><span class="line">	 2.max   最大值</span><br><span class="line">	 3.min   最小值</span><br><span class="line">	 4.avg   平均值</span><br><span class="line">	 5.<span class="built_in">sum</span>   求和</span><br><span class="line">	select count(*) from 表名;求所有数量</span><br><span class="line">	select count(字段名) from 表名;</span><br><span class="line">	</span><br><span class="line">	selcet avg（age） from 表名;求平均年龄</span><br><span class="line">	select max（age）from 表名; 求最大年龄</span><br><span class="line">	select <span class="built_in">sum</span>（字段名） from 表名 [条件];</span><br><span class="line">	注：null值不参与所有聚合函数运算</span><br></pre></td></tr></table></div></figure>

<p>4.分组查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select 字段 from 表名 [<span class="built_in">where</span> 条件] group by 分组字段名[having 分组后过滤条件];</span><br><span class="line"><span class="built_in">where</span>与having区别</span><br><span class="line">	执行时机不同：<span class="built_in">where</span>是在分组之前进行过滤，不满足<span class="built_in">where</span>条件不参与分组</span><br><span class="line">	而having是分组之后对结果进行过滤;</span><br><span class="line">	判断条件不同：<span class="built_in">where</span>不能对聚合函数进行判断，而having可以;</span><br><span class="line">例：</span><br><span class="line">1.根据性别分组，统计男员工和女员工的数量</span><br><span class="line">select 字段名, count(*) from 表名 group by 字段名;</span><br><span class="line">2.查询年龄小于45的员工，并且根据工作地址分组，获取员工量大于等于3的工作地址</span><br><span class="line">select 工作地址字段， count(*) from 表名 <span class="built_in">where</span> age&lt;=45 group by 工作地址字段 having count（*）&gt;=3</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>5.排序查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">注：如果是多字段排序，当第一个字段值相同时，才会根据第二字段排序</span><br><span class="line">升序是默认的(asc可以省略)</span><br><span class="line">升序：select * from 表名 order by 字段名 asc；</span><br><span class="line">降序：select * from 表名 order by 字段名 desc；</span><br><span class="line">多字段排序</span><br><span class="line">例：根据年龄对公司员工进行升序排序，年龄相同，再按照入职时间降序排序</span><br><span class="line">select * from 表名 oredr by 字段名 asc，字段名 desc;</span><br></pre></td></tr></table></div></figure>
<p>6.分页查询</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * (或字段名) from 表名 <span class="built_in">limit</span> 0,10; 查询第一页的十条记录</span><br><span class="line">sleect * from 表名 <span class="built_in">limit</span> 10,10;查询第二页的十条记录</span><br><span class="line">注：起始索引从0开始，起始索引=（查询的页数-1）*每页记录数；</span><br><span class="line">      不同数据库有不同实现，mysql 与 Oracle不同</span><br><span class="line">       查询的第一页数据，起始索引可以省略，直接简写为limint 10;</span><br></pre></td></tr></table></div></figure>

<p>7.DQL-执行顺序</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from-&gt;<span class="built_in">where</span>-&gt;group by-&gt;having-&gt;select-&gt;order by -&gt;<span class="built_in">limit</span>;</span><br></pre></td></tr></table></div></figure>


        <h3 id="四-DCL-用户管理"   >
          <a href="#四-DCL-用户管理" class="heading-link"><i class="fas fa-link"></i></a><a href="#四-DCL-用户管理" class="headerlink" title="四.DCL-用户管理"></a>四.DCL-用户管理</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.创建用户a,只能在当前主机localhost访问，密码123456</span><br><span class="line">create user <span class="string">&#x27;a&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">2.创建用户b,可以在任意主机访问数据库，密码123456</span><br><span class="line">create user <span class="string">&#x27;b&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">3.修改用户b,的访问密码为1234</span><br><span class="line">alter user <span class="string">&#x27;b&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified with mysql_native_password by <span class="string">&#x27;1234&#x27;</span>;</span><br><span class="line"></span><br><span class="line">4.删除a@localhost用户</span><br><span class="line">drop user <span class="string">&#x27;a&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></div></figure>

<p>2.DCL-权限控制</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">查询权限</span><br><span class="line">show grants <span class="keyword">for</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>（用户名）</span><br><span class="line"></span><br><span class="line">授予权限</span><br><span class="line">grant all on 数据库1.*  to  <span class="string">&#x27;b&#x27;</span>@<span class="string">&#x27;%&#x27;</span>（用户名）-&gt;针对数据库1的所有权限</span><br><span class="line"></span><br><span class="line">撤销权限</span><br><span class="line">revoke 权限列表 on 数据库名.表名 from <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>；</span><br><span class="line">注：多个权限之间，使用逗号分割</span><br><span class="line">	授权时，数据库名和表名可以使用*进行通配，代表所有</span><br></pre></td></tr></table></div></figure>


        <h3 id="五-函数"   >
          <a href="#五-函数" class="heading-link"><i class="fas fa-link"></i></a><a href="#五-函数" class="headerlink" title="五.函数"></a>五.函数</h3>
      <p>1.-常见字符串函数</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.字符串拼接 concat</span><br><span class="line">	select concat（<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;Mysql&#x27;</span>）;</span><br><span class="line">	</span><br><span class="line">.转换成小写lower</span><br><span class="line">	select lower（<span class="string">&#x27;Hello&#x27;</span>）;</span><br><span class="line"></span><br><span class="line">.upper（）--&gt;转换成大写</span><br><span class="line"></span><br><span class="line">.lpad左填充  lapd(<span class="string">&#x27;01&#x27;</span>,5,<span class="string">&#x27;-&#x27;</span>)--&gt;---01</span><br><span class="line">.rpad右填充  rapd(<span class="string">&#x27;01&#x27;</span>,5,<span class="string">&#x27;-&#x27;</span>)--&gt;01---</span><br><span class="line">注：（<span class="string">&#x27;字符串&#x27;</span>，字符串位数，<span class="string">&#x27;要填充的内容&#x27;</span>）</span><br><span class="line"></span><br><span class="line">.trim（） 去除空格-只能去除头部和尾部空格</span><br><span class="line">.substring 截取字符串</span><br><span class="line">substring (<span class="string">&#x27;hello mysql&#x27;</span>,1,5);截取从一到五的字符</span><br><span class="line"></span><br><span class="line">例：将工号统一为5位数，不足的前面补0</span><br><span class="line">update 表名 <span class="built_in">set</span> 字段名=lpad(字段名，5，<span class="string">&#x27;0&#x27;</span>);</span><br></pre></td></tr></table></div></figure>

<p>2.常见的数值函数</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">--ceil  向上取整 如ceil(1.1)--&gt;2</span><br><span class="line">--floor 向下取整 如floor(1.9)--&gt;1</span><br><span class="line">--mod   求模运算 如mod(7,4)--&gt;3</span><br><span class="line">--rand  0-1之间的随机数</span><br><span class="line">--round 四舍五入 如round(2.345,2)--&gt;2.35</span><br><span class="line">		--对2.345进行四舍五入，保留两位小数</span><br></pre></td></tr></table></div></figure>


<p>3.常见的日期函数</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--curdate(); 当前年月日</span><br><span class="line">--curtime(); 当前时分秒</span><br><span class="line">--new();当前年月日时分秒</span><br><span class="line">--yuar(new());当前时间的年份</span><br><span class="line">--month(new());当前时间的月份</span><br><span class="line">--day(new());当前时间的天数</span><br><span class="line">--date_add </span><br><span class="line">例：date_add（new(),interval 70 day）;</span><br><span class="line">	表示当前时间70天后的时间</span><br><span class="line">--dateiff（<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>）求两个时间之间的差数</span><br></pre></td></tr></table></div></figure>

<p>4.流程控制</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">--<span class="keyword">if</span> (<span class="literal">false</span>,<span class="string">&#x27;ok&#x27;</span>,<span class="string">&#x27;error&#x27;</span>)如果第一个为<span class="literal">false</span>则返回error</span><br><span class="line">--ifnull（<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;default&#x27;</span>）第一个为null则返回第二个，否则返回第一个</span><br><span class="line">--<span class="keyword">case</span> when <span class="keyword">then</span> <span class="keyword">else</span> end</span><br><span class="line">	select name,</span><br><span class="line">	(<span class="keyword">case</span> workaddress when <span class="string">&#x27;北京&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;一线城市&#x27;</span> </span><br><span class="line">	when <span class="string">&#x27;上海&#x27;</span> them <span class="string">&#x27;一线城市&#x27;</span>..</span><br><span class="line">	<span class="keyword">else</span> <span class="string">&#x27;二线城市&#x27;</span> end)as <span class="string">&#x27;工作地址&#x27;</span></span><br><span class="line">	from 表名</span><br><span class="line"></span><br><span class="line">例：成绩&gt;=85优秀 成绩&gt;=60及格 否则不及格</span><br><span class="line">select </span><br><span class="line">	<span class="built_in">id</span>，</span><br><span class="line">	name,</span><br><span class="line">	   （<span class="keyword">case</span> when  math&gt;=85 <span class="keyword">then</span> <span class="string">&#x27;优秀&#x27;</span> </span><br><span class="line">		when math&gt;=60 <span class="keyword">then</span> <span class="string">&#x27;及格&#x27;</span> </span><br><span class="line">		<span class="keyword">else</span> <span class="string">&#x27;不及格&#x27;</span> end)as <span class="string">&#x27;数学&#x27;</span> ,</span><br><span class="line">	    (english....),</span><br><span class="line">	    (chinese....) </span><br><span class="line">from 表名</span><br></pre></td></tr></table></div></figure>


        <h3 id="六-约束"   >
          <a href="#六-约束" class="heading-link"><i class="fas fa-link"></i></a><a href="#六-约束" class="headerlink" title="六.约束"></a>六.约束</h3>
      <p>概念：约束是作用于表中字段上的规则，用于限制存储在表中的数据<br>目的：保证数据库中数据的正确、有效和完整性</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">分类：</span><br><span class="line"> 非空约束 not null       限制该字段数据不能为null</span><br><span class="line"> 唯一约束 unique         保证该字段的所有数据都唯一，不重复</span><br><span class="line">                        如：身份证号、手机号、用户名..</span><br><span class="line"> 主键约束 primary key    非空且唯一</span><br><span class="line"> 默认约束 default        保存数据时候，如未指定该字段的值，则采用默认值</span><br><span class="line"> 检查约束 check          保证字段值满足某一条件</span><br><span class="line"> 外键约束 foreing key    用来让两张表之间建立链接，</span><br><span class="line">                        保证数据的一致性和完整性</span><br><span class="line"> 自动增长 auto_increment</span><br><span class="line">例：</span><br><span class="line">  creat table user(</span><br><span class="line">      <span class="built_in">id</span> int primary key auto_increment comment <span class="string">&#x27;主键&#x27;</span>，</span><br><span class="line">      name varcher(10) not null unique comment <span class="string">&#x27;姓名&#x27;</span>，</span><br><span class="line">      age int check（age&gt;0 &amp;&amp; age&lt;120）comment <span class="string">&#x27;年龄&#x27;</span>，</span><br><span class="line">      status char（1） default <span class="string">&#x27;1&#x27;</span> comment <span class="string">&#x27;状态&#x27;</span>，</span><br><span class="line">      gender char(1) comment <span class="string">&#x27;性别&#x27;</span></span><br><span class="line">   )comment <span class="string">&#x27;用户表&#x27;</span></span><br></pre></td></tr></table></div></figure>

<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">添加外键</span><br><span class="line">alter table 表名 add constraint fk_表名_字段名 foreign key （字段名）references 主表（<span class="built_in">id</span>）</span><br><span class="line">删除外键</span><br><span class="line">alter table 表名 drop foreign key fk_表名_字段名</span><br><span class="line"></span><br><span class="line">外键约束-删除更新行为</span><br><span class="line">no action（默认） 如果要删除父表中的数据，要先检查是否有对应的外键，如果有则不允许删除 </span><br><span class="line">restrict（默认）  同上</span><br><span class="line"></span><br><span class="line">cascade   父表的更新或者删除操作，会检查该记录是否有对应的外键，如果有，则子表也会被删除或者更新</span><br><span class="line"><span class="built_in">set</span> null  父表删除或者更新操作，会检查该记录是否有对应的外键，主表数据被删除，则对应从表会变成null</span><br><span class="line">alter table 表名 add constraint fk_表名_字段名 foreign key （字段名）references 主表（<span class="built_in">id</span>） on update <span class="built_in">set</span> null on delete <span class="built_in">set</span> null；</span><br></pre></td></tr></table></div></figure>

<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">作者：yliw</span><br><span class="line">时间：2022/8/16</span><br><span class="line">                 仅供学习，若有错误，请联系作者指正。</span><br></pre></td></tr></table></div></figure></div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://lessan.oss-cn-beijing.aliyuncs.com/tx.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">哇哦yliw...</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">4</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">7</div><div class="sidebar-ov-state-item__name">分类</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">标签</div></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>yliw</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script></body></html>